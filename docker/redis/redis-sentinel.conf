# ================================
# Redis Sentinel Configuration for High Availability
# ================================
# Provides automatic failover and monitoring for Redis production setup

# ================================
# Basic Configuration
# ================================
port 26379
bind 0.0.0.0

# Working directory
dir /data

# Log configuration
logfile /var/log/redis/sentinel.log
loglevel notice

# ================================
# Master Configuration
# ================================
# Monitor the master Redis instance
# Format: sentinel monitor <master-name> <ip> <port> <quorum>
sentinel monitor sightedit-master redis-master 6379 2

# Authentication for master
sentinel auth-pass sightedit-master CHANGE_THIS_REDIS_PASSWORD_IN_PRODUCTION

# ================================
# Failover Configuration
# ================================
# Milliseconds to wait before considering master down
sentinel down-after-milliseconds sightedit-master 30000

# Timeout for failover operation
sentinel failover-timeout sightedit-master 180000

# Number of replicas to reconfigure during failover
sentinel parallel-syncs sightedit-master 1

# ================================
# Notification Scripts
# ================================
# Script to run when master changes (for notification/automation)
sentinel notification-script sightedit-master /usr/local/bin/redis-notify.sh

# Script to run during failover for custom actions
sentinel client-reconfig-script sightedit-master /usr/local/bin/redis-failover.sh

# ================================
# Security Configuration
# ================================
# Require password for sentinel commands
requirepass CHANGE_THIS_SENTINEL_PASSWORD_IN_PRODUCTION

# ================================
# Advanced Configuration
# ================================
# Deny dangerous commands
sentinel deny-scripts-reconfig yes

# Enable protected mode
protected-mode yes

# ================================
# Multiple Master Support (if needed)
# ================================
# Example for monitoring multiple Redis instances
# sentinel monitor sightedit-cache redis-cache 6380 2
# sentinel auth-pass sightedit-cache CACHE_PASSWORD
# sentinel down-after-milliseconds sightedit-cache 30000
# sentinel failover-timeout sightedit-cache 180000
# sentinel parallel-syncs sightedit-cache 1